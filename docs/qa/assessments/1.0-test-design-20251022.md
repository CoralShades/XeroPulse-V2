# Test Design: Story 1.0 - Initialize Next.js Project with Vercel Supabase Template

**Date:** 2025-10-22
**Designer:** Quinn (Test Architect)
**Story ID:** 1.0
**Story Title:** Initialize Next.js Project with Vercel Supabase Template

---

## Test Strategy Overview

**Total Test Scenarios:** 24
**Test Distribution:**
- **Unit Tests:** 0 (0%) - No isolated logic to test in setup story
- **Integration Tests:** 10 (42%) - Component interaction and configuration verification
- **E2E Tests:** 14 (58%) - Manual verification and deployment validation

**Priority Distribution:**
- **P0 (Critical):** 8 scenarios (33%) - Security, auth, and deployment must-haves
- **P1 (High):** 10 scenarios (42%) - Core functionality and configuration
- **P2 (Medium):** 6 scenarios (25%) - Branding and nice-to-have verifications

**Test Approach:**
This is an infrastructure and setup story with no custom business logic. Testing focuses on **manual verification** and **configuration validation** rather than automated unit tests. Integration and E2E tests verify that template components work correctly after customization.

**Risk-Based Focus:**
Test design prioritizes the two high-risk security concerns identified in risk profile:
- SEC-001: Environment Variable Exposure (5 test scenarios)
- SEC-002: Auth Callback URL Misconfiguration (4 test scenarios)

---

## Test Scenarios by Acceptance Criteria

### AC1: Next.js 15 project created using Vercel's Supabase template

**Requirement:** Successful template deployment from Vercel

#### Test Scenarios

| ID | Level | Priority | Test Scenario | Justification | Mitigates Risk |
|----|-------|----------|---------------|---------------|----------------|
| 1.0-INT-001 | Integration | P1 | Verify Vercel deployment wizard completes successfully | Critical deployment path | OPS-001 |
| 1.0-E2E-001 | E2E | P1 | Access production URL and verify app loads | End-to-end deployment validation | OPS-001 |
| 1.0-E2E-002 | E2E | P2 | Verify deployed app shows Vercel template default UI | Confirms correct template used | - |

**Test Steps:**

**1.0-INT-001: Deployment Wizard**
```yaml
steps:
  - Click "Deploy" button on Vercel template page
  - Connect GitHub account
  - Select repository name
  - Configure Supabase environment variables
  - Click "Deploy"
  - Wait for build completion
expected_result: Build succeeds, production URL generated
```

**1.0-E2E-001: Production URL Access**
```yaml
steps:
  - Navigate to https://xeropulse.vercel.app (or assigned URL)
  - Verify page loads without errors
  - Check browser console for errors (should be none)
  - Verify no 404 or 500 errors
expected_result: App loads successfully with 200 status
```

---

### AC2: Project deployed to Vercel with production URL accessible via HTTPS

**Requirement:** HTTPS enabled and SSL certificate valid

#### Test Scenarios

| ID | Level | Priority | Test Scenario | Justification | Mitigates Risk |
|----|-------|----------|---------------|---------------|----------------|
| 1.0-E2E-003 | E2E | P0 | Verify HTTPS certificate is valid and trusted | Security requirement | SEC-001 |
| 1.0-E2E-004 | E2E | P1 | Test HTTP to HTTPS redirect | Best practice validation | - |
| 1.0-INT-002 | Integration | P1 | Verify Vercel SSL certificate auto-provisioning | Infrastructure validation | OPS-001 |

**Test Steps:**

**1.0-E2E-003: SSL Certificate Validation**
```bash
# Command-line test
curl -vI https://xeropulse.vercel.app 2>&1 | grep "SSL certificate"

# Expected output:
# * SSL certificate verify ok.
# * Server certificate: *.vercel.app

# Browser test:
# - Click padlock icon in address bar
# - Verify "Connection is secure"
# - Check certificate issuer (should be Let's Encrypt or Vercel CA)
# - Verify expiration date is > 60 days in future
```

**1.0-E2E-004: HTTP Redirect**
```bash
curl -I http://xeropulse.vercel.app

# Expected:
# HTTP/1.1 308 Permanent Redirect
# Location: https://xeropulse.vercel.app
```

---

### AC3: Supabase client configured with environment variables

**Requirement:** Correct environment variable setup for local and production

#### Test Scenarios

| ID | Level | Priority | Test Scenario | Justification | Mitigates Risk |
|----|-------|----------|---------------|---------------|----------------|
| 1.0-INT-003 | Integration | P0 | Verify `.env.local` contains required Supabase variables | Critical configuration | SEC-001 |
| 1.0-INT-004 | Integration | P0 | Verify `SUPABASE_SERVICE_ROLE_KEY` does NOT have `NEXT_PUBLIC_` prefix | Security validation | **SEC-001** |
| 1.0-INT-005 | Integration | P0 | Verify client bundle does not expose service role key | Security validation | **SEC-001** |
| 1.0-E2E-005 | E2E | P0 | Test Supabase client connection on localhost | Integration validation | SEC-001 |
| 1.0-E2E-006 | E2E | P0 | Test Supabase client connection on production | Integration validation | OPS-001 |

**Test Steps:**

**1.0-INT-003: Environment Variable Verification**
```bash
# Check .env.local file exists and contains required variables
cat .env.local

# Required variables:
# NEXT_PUBLIC_SUPABASE_URL=https://[project-ref].supabase.co
# NEXT_PUBLIC_SUPABASE_ANON_KEY=[anon-key]
# SUPABASE_SERVICE_ROLE_KEY=[service-key]  # NO NEXT_PUBLIC_ prefix!

# Verify values are not placeholder defaults
grep -E "your-project|your-anon-key" .env.local
# Expected: No matches (empty result)
```

**1.0-INT-004: Service Role Key Security Audit** ⭐ **CRITICAL SECURITY TEST**
```bash
# Step 1: Verify service role key variable naming
grep "NEXT_PUBLIC_.*SERVICE_ROLE" .env.local
# Expected: No matches (if found, CRITICAL SECURITY ISSUE)

# Step 2: Verify correct naming
grep "^SUPABASE_SERVICE_ROLE_KEY=" .env.local
# Expected: Match found (variable exists with correct name)

# Step 3: Check Vercel environment variables
# In Vercel dashboard → Settings → Environment Variables
# Verify "SUPABASE_SERVICE_ROLE_KEY" is NOT exposed to client
```

**1.0-INT-005: Client Bundle Inspection** ⭐ **CRITICAL SECURITY TEST**
```bash
# Build production bundle
npm run build

# Search for service role key in client bundles
grep -r "SERVICE_ROLE_KEY" .next/static/

# Expected: No matches (key should NOT appear in client code)
# If found: FAIL - Service role key exposed to client

# Alternative: Search for actual key value
grep -r "[actual-service-role-key-value]" .next/static/
# Expected: No matches
```

**1.0-E2E-005: Supabase Connection Test (Localhost)**
```typescript
// Create test page: app/test-supabase/page.tsx
import { createClient } from '@/lib/supabase/client'

export default function TestPage() {
  const supabase = createClient()

  // Attempt to query Supabase
  const testConnection = async () => {
    const { data, error } = await supabase.from('users').select('count')
    if (error) console.error('Connection failed:', error)
    else console.log('Connection successful:', data)
  }

  return <button onClick={testConnection}>Test Supabase</button>
}

// Test steps:
// 1. Run `npm run dev`
// 2. Navigate to http://localhost:3000/test-supabase
// 3. Open browser console
// 4. Click "Test Supabase" button
// 5. Verify no CORS errors
// 6. Verify connection succeeds or fails with valid Supabase error
```

---

### AC4: Base authentication UI components working

**Requirement:** Login, signup, logout functionality from template

#### Test Scenarios

| ID | Level | Priority | Test Scenario | Justification | Mitigates Risk |
|----|-------|----------|---------------|---------------|----------------|
| 1.0-E2E-007 | E2E | P0 | Complete signup flow with test user | Critical auth path | **SEC-002** |
| 1.0-E2E-008 | E2E | P0 | Complete login flow with created user | Critical auth path | **SEC-002** |
| 1.0-E2E-009 | E2E | P0 | Verify logout clears session and redirects to login | Auth security validation | SEC-002 |
| 1.0-E2E-010 | E2E | P0 | Verify auth callback URL is whitelisted in Supabase | Configuration validation | **SEC-002** |
| 1.0-E2E-011 | E2E | P1 | Test session persistence across page refreshes | UX validation | - |
| 1.0-E2E-012 | E2E | P1 | Attempt login with invalid credentials (negative test) | Error handling validation | - |

**Test Steps:**

**1.0-E2E-007: Signup Flow** ⭐ **CRITICAL AUTH TEST**
```yaml
preconditions:
  - Supabase project has email auth enabled
  - Auth callback URL configured in Supabase dashboard

steps:
  1. Navigate to /signup (or template's signup route)
  2. Enter test email: test-user-001@xeropulse.test
  3. Enter strong password: TestPass123!Secure
  4. Click "Sign Up" button
  5. Wait for response

expected_results:
  - No JavaScript errors in console
  - Redirect to /auth/callback or authenticated page
  - User record created in Supabase Auth dashboard
  - Session cookie set in browser (check DevTools → Application → Cookies)
  - No "callback URL not whitelisted" errors

failure_modes:
  - "Invalid callback URL" → SEC-002 risk materialized, FAIL test
  - "Email already registered" → Delete user from Supabase and retry
  - "Network error" → Check Supabase connection
```

**1.0-E2E-008: Login Flow** ⭐ **CRITICAL AUTH TEST**
```yaml
preconditions:
  - Test user created in E2E-007

steps:
  1. Navigate to /login
  2. Enter test email: test-user-001@xeropulse.test
  3. Enter password: TestPass123!Secure
  4. Click "Login" button
  5. Wait for authentication

expected_results:
  - Redirect to authenticated page (/ or /dashboard)
  - Session cookie set
  - No errors in console
  - User shown as logged in (check for username/avatar display)

negative_test:
  - Enter wrong password → Expect "Invalid credentials" error
  - Enter non-existent email → Expect error message
```

**1.0-E2E-010: Callback URL Configuration Audit** ⭐ **CRITICAL CONFIG TEST**
```yaml
steps:
  1. Access Supabase dashboard → Authentication → URL Configuration
  2. Verify "Site URL" is set correctly
  3. Verify "Redirect URLs" includes:
     - http://localhost:3000/auth/callback
     - https://xeropulse.vercel.app/auth/callback
     - https://*.vercel.app/auth/callback (for preview deployments)
  4. Screenshot configuration for test evidence

expected_results:
  - All URLs whitelisted
  - No wildcard in production URL (security risk)
  - Localhost URL for development

failure_action:
  - If URLs missing → Add immediately, re-test E2E-007 and E2E-008
  - Document configuration in test report
```

---

### AC5: Project customized with XeroPulse branding

**Requirement:** Logo, colors, typography applied

#### Test Scenarios

| ID | Level | Priority | Test Scenario | Justification | Mitigates Risk |
|----|-------|----------|---------------|---------------|----------------|
| 1.0-E2E-013 | E2E | P2 | Verify XeroPulse logo displays on all pages | Branding validation | BUS-001 |
| 1.0-E2E-014 | E2E | P2 | Verify custom color palette applied to auth pages | Branding validation | BUS-001 |
| 1.0-INT-006 | Integration | P2 | Verify favicon and app icons updated | Branding completeness | BUS-001 |
| 1.0-E2E-015 | E2E | P2 | Verify page titles contain "XeroPulse" branding | SEO and branding | BUS-001 |

**Test Steps:**

**1.0-E2E-013: Logo Visual Verification**
```yaml
pages_to_check:
  - /login
  - /signup
  - / (home page)
  - /dashboard (if exists)

steps:
  1. Navigate to each page
  2. Verify XeroPulse logo visible in header
  3. Check logo image loads (not broken link)
  4. Verify logo links to home page when clicked

expected_results:
  - Logo present on all pages
  - Logo is correct XeroPulse branding
  - Logo resolution is crisp (not pixelated)
```

**1.0-INT-006: Icon Files Verification**
```bash
# Check favicon files exist
ls public/favicon.ico
ls public/icon*.png
ls public/apple-touch-icon.png

# Verify favicon is not default Next.js icon
file public/favicon.ico
# Should show XeroPulse favicon, not Next.js default

# Test in browser
# - Open app in new tab
# - Check browser tab shows XeroPulse favicon
# - Check bookmark uses correct icon
```

---

### AC6: Additional dependencies installed (shadcn/ui, Tailwind theme)

**Requirement:** shadcn/ui v4 and dependencies installed without conflicts

#### Test Scenarios

| ID | Level | Priority | Test Scenario | Justification | Mitigates Risk |
|----|-------|----------|---------------|---------------|----------------|
| 1.0-INT-007 | Integration | P1 | Verify shadcn/ui components installed correctly | Dependency validation | TECH-002 |
| 1.0-INT-008 | Integration | P1 | Verify no npm dependency conflicts | Build stability | TECH-002 |
| 1.0-E2E-016 | E2E | P1 | Render shadcn/ui Button component with template styles | Integration validation | TECH-002 |

**Test Steps:**

**1.0-INT-007: shadcn/ui Installation Verification**
```bash
# Check shadcn components directory exists
ls components/ui/

# Verify key components installed
ls components/ui/button.tsx
ls components/ui/input.tsx
ls components/ui/card.tsx
ls components/ui/label.tsx

# Check components.json config file
cat components.json

# Verify Tailwind config includes shadcn/ui plugin
grep "components/ui" tailwind.config.ts
```

**1.0-INT-008: Dependency Conflict Check**
```bash
# Run npm install and check for peer dependency warnings
npm install 2>&1 | grep "WARN"

# Expected: No critical warnings
# Acceptable: Minor version warnings for dev dependencies

# Check for conflicting versions
npm list tailwindcss
npm list @radix-ui/react-slot

# Verify no duplicate package installations
npm dedupe
```

**1.0-E2E-016: shadcn/ui Component Rendering**
```typescript
// Create test page: app/test-ui/page.tsx
import { Button } from '@/components/ui/button'
import { Input } from '@/components/ui/input'
import { Card } from '@/components/ui/card'

export default function TestUIPage() {
  return (
    <div className="p-8">
      <Card className="p-4">
        <h2>shadcn/ui Test</h2>
        <Button variant="default">Primary Button</Button>
        <Button variant="outline">Outline Button</Button>
        <Input placeholder="Test input" />
      </Card>
    </div>
  )
}

// Test steps:
// 1. Navigate to /test-ui
// 2. Verify components render with correct styles
// 3. Verify no CSS conflicts (check DevTools → Styles panel)
// 4. Test button hover states
// 5. Test input focus states
```

---

### AC7: Project structure reorganized to align with XeroPulse architecture

**Requirement:** Directory structure matches target architecture

#### Test Scenarios

| ID | Level | Priority | Test Scenario | Justification | Mitigates Risk |
|----|-------|----------|---------------|---------------|----------------|
| 1.0-INT-009 | Integration | P1 | Verify target directory structure created | Architecture compliance | TECH-001 |
| 1.0-E2E-017 | E2E | P1 | Test path aliases work for imports | Build validation | TECH-001 |
| 1.0-E2E-018 | E2E | P0 | Verify auth flow still works after reorganization | Regression prevention | **TECH-001** |

**Test Steps:**

**1.0-INT-009: Directory Structure Verification**
```bash
# Check target directory structure exists
tree -L 3 app/

# Expected structure:
# app/
# ├── (auth)/
# │   ├── login/
# │   ├── signup/
# │   └── reset-password/
# ├── (portal)/
# ├── api/
# ├── layout.tsx
# └── page.tsx

# Check components structure
tree -L 2 components/

# Expected:
# components/
# ├── ui/          # shadcn/ui components
# ├── auth/        # Auth-specific components
# ├── dashboard/   # Dashboard components
# └── layout/      # Layout components

# Check lib structure
tree -L 2 lib/

# Expected:
# lib/
# ├── supabase/
# ├── utils/
# └── types/
```

**1.0-E2E-017: Path Alias Testing**
```typescript
// Test import with path alias
import { Button } from '@/components/ui/button'
import { createClient } from '@/lib/supabase/client'
import { cn } from '@/lib/utils/cn'

// Run TypeScript check
// $ tsc --noEmit
// Expected: No import errors

// Run dev server
// $ npm run dev
// Expected: App starts successfully, no module resolution errors
```

**1.0-E2E-018: Auth Regression Test After Reorganization** ⭐ **CRITICAL REGRESSION TEST**
```yaml
preconditions:
  - Directory structure reorganized
  - Files moved to new locations

test_scenario:
  - Re-run 1.0-E2E-007 (Signup flow)
  - Re-run 1.0-E2E-008 (Login flow)
  - Re-run 1.0-E2E-009 (Logout flow)

expected_results:
  - All auth flows still work
  - No broken imports
  - No routing errors

failure_action:
  - If auth breaks → CRITICAL - Rollback reorganization
  - Fix import paths
  - Verify middleware still finds auth routes
  - Re-test
```

---

### AC8: Development environment verified

**Requirement:** `npm run dev` works, hot reload functional

#### Test Scenarios

| ID | Level | Priority | Test Scenario | Justification | Mitigates Risk |
|----|-------|----------|---------------|---------------|----------------|
| 1.0-INT-010 | Integration | P1 | Verify `npm run dev` starts server successfully | Dev environment validation | - |
| 1.0-E2E-019 | E2E | P1 | Test hot reload with component change | Dev experience validation | - |

**Test Steps:**

**1.0-INT-010: Dev Server Start**
```bash
# Start dev server
npm run dev

# Expected output:
# - ready started server on 0.0.0.0:3000
# - Local: http://localhost:3000
# - No compilation errors

# Verify server responds
curl http://localhost:3000

# Expected: HTML response (200 status)
```

**1.0-E2E-019: Hot Reload Test**
```yaml
steps:
  1. Start dev server: `npm run dev`
  2. Open browser to http://localhost:3000
  3. Open app/page.tsx in editor
  4. Make visible change (e.g., change heading text)
  5. Save file
  6. Watch browser (do NOT manually refresh)

expected_results:
  - Page updates automatically within 1-2 seconds
  - No full page reload required
  - No console errors
  - Change visible on screen

failure_modes:
  - No update → Check Fast Refresh is enabled
  - Full page reload → Acceptable but suboptimal
  - Errors → Check Next.js logs
```

---

### AC9: TypeScript configuration validated (strict mode enabled)

**Requirement:** No type errors, strict mode enabled

#### Test Scenarios

| ID | Level | Priority | Test Scenario | Justification | Mitigates Risk |
|----|-------|----------|---------------|---------------|----------------|
| 1.0-E2E-020 | E2E | P1 | Run `tsc --noEmit` and verify no type errors | Type safety validation | TECH-003 |
| 1.0-E2E-021 | E2E | P1 | Verify `tsconfig.json` has strict mode enabled | Configuration validation | TECH-003 |

**Test Steps:**

**1.0-E2E-020: TypeScript Compilation Check**
```bash
# Run TypeScript compiler without emitting files
npx tsc --noEmit

# Expected output:
# (silent - no errors)
# Exit code: 0

# If errors found:
# - Review each error
# - Fix type issues
# - Re-run until clean
```

**1.0-E2E-021: tsconfig.json Audit**
```bash
# Check strict mode settings
cat tsconfig.json | grep -A 10 '"strict"'

# Required settings:
# "strict": true,
# "noUncheckedIndexedAccess": true,
# "noUnusedLocals": true,
# "noUnusedParameters": true,

# Verify path aliases configured
cat tsconfig.json | grep -A 5 '"paths"'

# Expected:
# "@/*": ["./*"],
# "@/components/*": ["components/*"],
# "@/lib/*": ["lib/*"]
```

---

### AC10: Git repository initialized with proper .gitignore

**Requirement:** Environment files and build artifacts not tracked

#### Test Scenarios

| ID | Level | Priority | Test Scenario | Justification | Mitigates Risk |
|----|-------|----------|---------------|---------------|----------------|
| 1.0-E2E-022 | E2E | P0 | Verify `.env.local` is NOT tracked by Git | Security validation | **DATA-001** |
| 1.0-E2E-023 | E2E | P1 | Verify `.gitignore` includes required patterns | Best practice validation | DATA-001 |
| 1.0-E2E-024 | E2E | P2 | Test pre-commit hook blocks sensitive files (if configured) | Security validation | DATA-001 |

**Test Steps:**

**1.0-E2E-022: .env.local Git Exclusion** ⭐ **CRITICAL SECURITY TEST**
```bash
# Check .env.local is not tracked
git status

# Expected: .env.local should NOT appear in output
# If it appears → FAIL - Security risk

# Verify .env.local in .gitignore
grep ".env.local" .gitignore

# Expected: Match found

# Test accidental add attempt
git add .env.local 2>&1

# Expected: Either warning or file not added
git status | grep ".env.local"
# Expected: No match (file not staged)
```

**1.0-E2E-023: .gitignore Completeness**
```bash
# Verify required patterns in .gitignore
cat .gitignore

# Must include:
# - node_modules/
# - .env.local
# - .env*.local
# - .next/
# - .vercel/
# - out/
# - build/
# - dist/

# Test by creating dummy files
touch .env.local .next/test.js node_modules/test.js
git status

# Expected: None of these files appear in git status
```

---

## Risk Coverage Matrix

Mapping test scenarios to identified risks from risk profile (`1.0-risk-20251022.md`):

| Risk ID | Risk Title | Test Scenarios | Priority |
|---------|------------|----------------|----------|
| **SEC-001** | Environment Variable Exposure | 1.0-INT-003, 1.0-INT-004, **1.0-INT-005**, 1.0-E2E-005, 1.0-E2E-006 | P0 |
| **SEC-002** | Auth Callback URL Misconfiguration | **1.0-E2E-007**, **1.0-E2E-008**, 1.0-E2E-009, **1.0-E2E-010** | P0 |
| **TECH-001** | Template Customization Complexity | 1.0-INT-009, 1.0-E2E-017, **1.0-E2E-018** | P1 |
| TECH-002 | Dependency Conflicts | 1.0-INT-007, 1.0-INT-008, 1.0-E2E-016 | P1 |
| TECH-003 | TypeScript Strict Mode Issues | 1.0-E2E-020, 1.0-E2E-021 | P1 |
| **DATA-001** | Credentials Leak to Git | **1.0-E2E-022**, 1.0-E2E-023, 1.0-E2E-024 | P0 |
| OPS-001 | Vercel Deployment Error | 1.0-INT-001, 1.0-E2E-001, 1.0-INT-002, 1.0-E2E-006 | P1 |
| BUS-001 | Incomplete Branding | 1.0-E2E-013, 1.0-E2E-014, 1.0-INT-006, 1.0-E2E-015 | P2 |

**Critical Test Scenarios (⭐):**
- 1.0-INT-004: Service role key security audit
- 1.0-INT-005: Client bundle inspection
- 1.0-E2E-007: Signup flow
- 1.0-E2E-008: Login flow
- 1.0-E2E-010: Callback URL configuration audit
- 1.0-E2E-018: Auth regression after reorganization
- 1.0-E2E-022: .env.local Git exclusion

**Coverage Assessment:** ✅ **COMPLETE**
- All 10 acceptance criteria have test coverage
- All 8 identified risks have mitigation tests
- 7 critical tests for P0 security concerns

---

## Test Execution Strategy

### Phase 1: Pre-Development Security Setup (Before Tasks 1-3)

**Objective:** Prevent security risks before they occur

**Tests to Execute:**
1. 1.0-E2E-010: Configure callback URLs in Supabase dashboard
2. Review environment variable naming conventions
3. Set up .gitignore before first commit

**Rationale:** SEC-001 and SEC-002 prevention through configuration

---

### Phase 2: Post-Template-Deployment Validation (After Task 1)

**Objective:** Verify base template works before customization

**Tests to Execute:**
1. 1.0-INT-001: Deployment wizard completion
2. 1.0-E2E-001: Production URL access
3. 1.0-E2E-003: HTTPS certificate validation
4. 1.0-E2E-004: HTTP to HTTPS redirect
5. 1.0-E2E-007: Signup flow (baseline)
6. 1.0-E2E-008: Login flow (baseline)

**Rationale:** Establish working baseline before customization (TECH-001 mitigation)

---

### Phase 3: Environment Configuration Validation (After Task 2)

**Objective:** Verify Supabase connection and security

**Tests to Execute:**
1. 1.0-INT-003: Environment variable verification
2. **1.0-INT-004: Service role key security audit** ⭐ CRITICAL
3. 1.0-E2E-005: Supabase connection (localhost)
4. 1.0-E2E-006: Supabase connection (production)
5. 1.0-E2E-022: .env.local Git exclusion
6. 1.0-E2E-023: .gitignore completeness

**Rationale:** SEC-001 and DATA-001 validation

---

### Phase 4: Dependency Installation Validation (After Task 4)

**Objective:** Verify shadcn/ui and dependencies installed correctly

**Tests to Execute:**
1. 1.0-INT-007: shadcn/ui installation verification
2. 1.0-INT-008: Dependency conflict check
3. 1.0-E2E-016: Component rendering test

**Rationale:** TECH-002 mitigation

---

### Phase 5: Post-Customization Regression (After Tasks 5-7)

**Objective:** Ensure customization didn't break functionality

**Tests to Execute:**
1. **1.0-E2E-018: Auth regression test** ⭐ CRITICAL
2. 1.0-E2E-017: Path alias testing
3. 1.0-INT-009: Directory structure verification
4. 1.0-E2E-013: Logo visual verification
5. 1.0-E2E-014: Color palette validation
6. 1.0-E2E-019: Hot reload test

**Rationale:** TECH-001 regression prevention, BUS-001 validation

---

### Phase 6: TypeScript and Build Validation (After Task 8)

**Objective:** Verify type safety and build success

**Tests to Execute:**
1. 1.0-E2E-020: TypeScript compilation check
2. 1.0-E2E-021: tsconfig.json audit
3. Build test: `npm run build` (ensure production build succeeds)

**Rationale:** TECH-003 mitigation

---

### Phase 7: Final Security Audit (Before Merging to Main)

**Objective:** Final verification of security controls

**Tests to Execute:**
1. **1.0-INT-005: Client bundle inspection** ⭐ CRITICAL
2. Re-run 1.0-E2E-007: Signup flow (final validation)
3. Re-run 1.0-E2E-008: Login flow (final validation)
4. Re-run 1.0-E2E-022: .env.local Git exclusion
5. 1.0-INT-002: SSL certificate provisioning

**Rationale:** SEC-001, SEC-002, DATA-001 final validation

---

## Test Data Requirements

### Supabase Test Users

Create dedicated test users for each test scenario:

```yaml
test_users:
  - email: test-user-001@xeropulse.test
    password: TestPass123!Secure
    purpose: 1.0-E2E-007 (Signup test)

  - email: test-user-002@xeropulse.test
    password: TestPass456!Secure
    purpose: 1.0-E2E-008 (Login test)

  - email: invalid-user@xeropulse.test
    password: WrongPassword123!
    purpose: 1.0-E2E-012 (Negative test - invalid credentials)
```

**Test Data Cleanup:**
- Delete test users from Supabase Auth after test execution
- Document test user credentials in password manager (not in Git)

---

## Test Environment Requirements

### Local Development Environment

**Required:**
- Node.js 18+ (verify with `node --version`)
- npm 9+ (verify with `npm --version`)
- Git 2.30+ (verify with `git --version`)
- Code editor (VS Code recommended)

**Configuration:**
- `.env.local` file with valid Supabase credentials
- Supabase project with Auth enabled
- GitHub account for Vercel deployment

---

### Vercel Production Environment

**Required:**
- Vercel account connected to GitHub
- Environment variables configured in Vercel dashboard
- Production URL assigned (e.g., xeropulse.vercel.app)

**Monitoring:**
- Vercel deployment logs enabled
- Vercel Analytics enabled (optional but recommended)

---

## Test Tooling

### Manual Testing Tools

1. **Browser DevTools**
   - Network tab (monitor API calls)
   - Console tab (check for errors)
   - Application tab (inspect cookies and session storage)
   - Elements tab (verify branding and styles)

2. **Command-Line Tools**
   - `curl` for HTTP/HTTPS testing
   - `grep` for file content verification
   - `tree` for directory structure visualization
   - `git` for version control validation

3. **Supabase Dashboard**
   - Authentication tab (verify users created)
   - Database tab (check for data)
   - Logs tab (review API calls)

### Automated Testing Tools (Future Enhancement)

**Not required for Story 1.0, but recommended for future stories:**

- **Playwright**: E2E auth flow automation
- **Jest**: Unit testing custom utilities
- **Testing Library**: Component testing
- **Husky**: Git pre-commit hooks

---

## Test Success Criteria

### Must Pass (Blocking)

All **P0** tests must pass:
- ✅ 1.0-INT-004: Service role key security audit
- ✅ 1.0-INT-005: Client bundle inspection
- ✅ 1.0-E2E-007: Signup flow
- ✅ 1.0-E2E-008: Login flow
- ✅ 1.0-E2E-010: Callback URL configuration
- ✅ 1.0-E2E-018: Auth regression test
- ✅ 1.0-E2E-022: .env.local Git exclusion
- ✅ 1.0-E2E-003: HTTPS certificate validation

**Failure Action:** FAIL quality gate, block deployment

---

### Should Pass (Non-Blocking)

All **P1** tests should pass:
- 10 integration and E2E tests
- If failures occur, document as known issues
- Must have mitigation plan before deployment

**Failure Action:** CONCERNS quality gate, deploy with documentation

---

### Nice to Pass (Advisory)

All **P2** tests are advisory:
- Branding and UX validation
- Failures can be fixed post-deployment

**Failure Action:** No gate impact, create follow-up tickets

---

## Test Execution Checklist

Use this checklist during test execution:

### Pre-Execution

- [ ] Supabase project created and credentials available
- [ ] Vercel account connected to GitHub
- [ ] Test users documented in password manager
- [ ] .env.local template prepared

### Phase 1: Security Setup

- [ ] 1.0-E2E-010: Callback URLs configured in Supabase
- [ ] Environment variable naming conventions reviewed
- [ ] .gitignore file reviewed and updated

### Phase 2: Template Deployment

- [ ] 1.0-INT-001: Deployment wizard completed
- [ ] 1.0-E2E-001: Production URL accessible
- [ ] 1.0-E2E-003: HTTPS certificate valid
- [ ] 1.0-E2E-007: Signup flow works (baseline)
- [ ] 1.0-E2E-008: Login flow works (baseline)

### Phase 3: Environment Configuration

- [ ] 1.0-INT-003: Environment variables verified
- [ ] **1.0-INT-004: Service role key audit PASSED** ⭐
- [ ] 1.0-E2E-005: Supabase connection (localhost) works
- [ ] 1.0-E2E-022: .env.local NOT tracked by Git

### Phase 4: Dependencies

- [ ] 1.0-INT-007: shadcn/ui installed correctly
- [ ] 1.0-INT-008: No dependency conflicts
- [ ] 1.0-E2E-016: Components render correctly

### Phase 5: Customization

- [ ] **1.0-E2E-018: Auth still works after reorganization** ⭐
- [ ] 1.0-INT-009: Directory structure correct
- [ ] 1.0-E2E-013: Logo displays correctly
- [ ] 1.0-E2E-019: Hot reload works

### Phase 6: TypeScript

- [ ] 1.0-E2E-020: No TypeScript errors
- [ ] 1.0-E2E-021: Strict mode enabled
- [ ] Production build succeeds

### Phase 7: Final Security Audit

- [ ] **1.0-INT-005: Client bundle clean** ⭐
- [ ] All auth flows re-tested and passing
- [ ] Security tests all green

### Post-Execution

- [ ] Test results documented
- [ ] Test users deleted from Supabase
- [ ] Test evidence captured (screenshots)
- [ ] Known issues documented

---

## Test Evidence Requirements

For quality gate approval, provide:

1. **Screenshots:**
   - Vercel deployment success page
   - Supabase callback URL configuration
   - Working login page with XeroPulse branding
   - Browser console showing no errors

2. **Command Output:**
   - `npm run build` success output
   - `tsc --noEmit` clean output
   - `git status` showing .env.local excluded
   - `grep` results showing no service role key in client bundle

3. **Test Results Summary:**
   - Test execution date
   - Pass/Fail status for each test
   - Failure details and mitigation plans
   - Risk coverage confirmation

---

## Known Limitations

### Manual Testing Only

Story 1.0 relies on manual testing. Automated test suites will be developed in future stories.

**Rationale:** Infrastructure setup stories don't justify automation investment for one-time setup.

---

### Template Dependency

Tests assume Vercel's Supabase template is stable. If template changes, tests may need updates.

**Mitigation:** Pin template version in documentation if possible.

---

## Test Maintenance

### When to Update Test Design

- New security risks identified
- Template structure changes
- New dependencies added
- Test failures reveal gaps

### Test Review Triggers

- Before each Epic 1 story implementation
- After any auth-related changes
- When Vercel or Supabase APIs change

---

## Summary

**Test Design Completeness:** ✅ **COMPREHENSIVE**

- **24 test scenarios** covering all 10 acceptance criteria
- **8 P0 critical tests** for security validation
- **Risk-based prioritization** aligned with risk profile
- **7-phase execution strategy** for incremental validation
- **Clear pass/fail criteria** for quality gate

**Recommended Quality Gate:** ✅ **PASS WITH CONCERNS**

**Conditions for PASS:**
- All P0 security tests pass (8 scenarios)
- SEC-001 and SEC-002 mitigation verified
- Auth flow working end-to-end
- Environment variables configured securely

**Test design location:** `docs/qa/assessments/1.0-test-design-20251022.md`
**Risk profile reference:** `docs/qa/assessments/1.0-risk-20251022.md`

---

**Test Design Generated:** 2025-10-22
**Next Action:** Execute Phase 1 tests before starting Story 1.0 development
